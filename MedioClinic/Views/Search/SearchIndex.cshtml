@using CMS.Search;
@using CMS.DocumentEngine;
@using MedioClinic.Models.SearchResult;
@using CMS.Helpers;

@model MedioClinic.Models.PageViewModel<SearchResultModel>

@if (!Model.Data.Items.Any())
{
    if (!String.IsNullOrWhiteSpace(Model.Data.Query))
    {
        <div class="container">
            <h3>No results found for <i>@Model.Data.Query</i></h3>
        </div>
    }
}
else
{
    <div class="container">
        <h3>Results for <i>@Model.Data.Query</i></h3>
        <div class="row">
            @foreach (SearchResultItem item in Model.Data.Items)
            {
                TreeProvider tp = new TreeProvider();
                var node = tp.SelectSingleDocument(item.Data.GetIntegerValue("DocumentID", 0));

                var siteDomain = ResHelper.GetString("RootDocument.AbsoluteURL");
                if (siteDomain == DocumentURLProvider.GetAbsoluteLiveSiteURL(node).ToLower())
                {
                    continue;
                }

                <div class="card">
                    <div class="card-content">
                        @switch (node.GetStringValue("ClassName", string.Empty))
                        {
                            case "MedioClinic.Doctor":
                                @PrintDoctor(node);
                                break;
                            case "MedioClinic.School":
                                @PrintSchool(node);
                                break;
                            default:
                                @PrintDefault(node);
                                break;
                        }
                    </div>
                </div>

                @*foreach (var col in item.Data.ColumnNames)
                {
                    <li>@col: @item.Data.GetValue(col)</li>
                }*@
            }
        </div>
    </div>
}


@helper PrintDoctor(TreeNode node)
{
    <div class="s12">
        <strong><a href="@DocumentURLProvider.GetAbsoluteLiveSiteURL(node).ToLower()">@node.GetStringValue("FirstName", string.Empty) @node.GetStringValue("LastName", string.Empty)</a></strong>
        <p>@Html.Raw(node.GetStringValue("Bio", string.Empty))</p>
    </div>
}

@helper PrintSchool(TreeNode node)
{
    <div class="s12">
        <strong><a href="@DocumentURLProvider.GetAbsoluteLiveSiteURL(node).ToLower()">@node.GetStringValue("SchoolName", string.Empty)</a></strong>
        <p>@Html.Raw(node.GetStringValue("Bio", string.Empty))</p>
    </div>
}

@helper PrintDefault(TreeNode node)
{
    <div class="s12">
        <strong><a href="@DocumentURLProvider.GetAbsoluteLiveSiteURL(node).ToLower()">@node.GetStringValue("NodeName", string.Empty)</a></strong>
    </div>
}